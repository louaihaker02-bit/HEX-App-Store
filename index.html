<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HEX App Store</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<style>
body { background: linear-gradient(135deg, #0d0d0d, #1a1a1a); color: #fff; font-family: Arial, sans-serif; }
.navbar, .footer { background: #111; }
.card { background: #1c1c1c; color: #fff; border-radius: 10px; transition: 0.3s; }
.card:hover { transform: scale(1.02); }
.app-image { width: 100%; height: 150px; object-fit: cover; border-radius: 5px; }
.download-btn { background-color: #28a745; color: #fff; }
.section-box { background: #222; padding: 20px; margin: 5px; border-radius: 10px; text-align: center; cursor: pointer; transition: 0.3s; }
.section-box:hover { background: #444; transform: scale(1.05); }
#appsContainer { margin-top: 20px; }
#adminPanel { display: none; background: #333; padding: 20px; border-radius: 10px; margin-top: 20px; }
.comment-box, .report-box { margin-top: 5px; }
.star { color: gold; cursor: pointer; }
</style>
</head>
<body>

<nav class="navbar navbar-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">HEX App Store</a>
    <div class="d-flex">
      <input id="searchInput" type="text" placeholder="بحث عن التطبيقات" class="form-control me-2">
      <button onclick="searchApp()" class="btn btn-outline-light">بحث</button>
    </div>
  </div>
</nav>

<div class="container mt-3">
<div class="d-flex flex-wrap justify-content-start mb-3">
  <div class="section-box" onclick="filterCategory('Android')">أندرويد</div>
  <div class="section-box" onclick="filterCategory('Windows')">ويندوز</div>
  <div class="section-box" onclick="filterCategory('الحماية')">الحماية</div>
  <div class="section-box" onclick="filterCategory('التصوير الفوتوغرافي')">التصوير</div>
  <div class="section-box" onclick="filterCategory('الصوت والفيديو')">الصوت والفيديو</div>
  <div class="section-box" onclick="filterCategory('إنتاجية')">إنتاجية</div>
  <div class="section-box" onclick="filterCategory('المحاكاة الافتراضية')">المحاكاة الافتراضية</div>
  <div class="section-box" onclick="filterCategory('أدوات الألعاب')">أدوات الألعاب</div>
  <div class="section-box" onclick="filterCategory('أدوات المطورين')">أدوات المطورين</div>
  <div class="section-box" onclick="filterCategory('التواصل')">التواصل</div>
  <div class="section-box" onclick="filterCategory('التخصيص')">التخصيص</div>
  <div class="section-box" onclick="filterCategory('هندسة')">هندسة</div>
  <div class="section-box" onclick="filterCategory('المرافق')">المرافق</div>
  <div class="section-box" onclick="filterCategory('أنظمة التشغيل')">أنظمة التشغيل</div>
</div>

<div id="appsContainer" class="row mt-3"></div>

<footer class="footer mt-5 p-3 text-center">
  <p id="policyText" style="cursor:pointer;">سياسة الاستخدام</p>
  <p>© 2026 HEX Store – All rights reserved | <a href="#">إخلاء المسؤولية</a></p>
</footer>

<div id="adminPanel">
  <h4>لوحة المطور المخفية</h4>
  <p>رفع تطبيق من حاسوبي أو رابط:</p>
  <input type="file" id="appFile" class="form-control mb-2">
  <input type="text" id="appLink" placeholder="رابط التطبيق (اختياري)" class="form-control mb-2">
  <input type="text" id="appName" placeholder="اسم التطبيق" class="form-control mb-2">
  <textarea id="appDesc" placeholder="وصف التطبيق" class="form-control mb-2"></textarea>
  <input type="file" id="appImageFile" class="form-control mb-2"> <!-- رفع صورة -->
  <input type="text" id="appVersion" placeholder="الإصدار" class="form-control mb-2">
  <select id="appPlatform" class="form-control mb-2">
    <option value="Android">Android</option>
    <option value="Windows">Windows</option>
  </select>
  <select id="appCategory" class="form-control mb-2">
    <option>الحماية</option><option>التصوير الفوتوغرافي</option>
    <option>الصوت والفيديو</option><option>إنتاجية</option>
    <option>المحاكاة الافتراضية</option><option>أدوات الألعاب</option>
    <option>أدوات المطورين</option><option>التواصل</option>
    <option>التخصيص</option><option>هندسة</option>
    <option>المرافق</option><option>أنظمة التشغيل</option>
  </select>
  <button class="btn btn-success mb-2" onclick="addApp()">رفع التطبيق</button>
  <hr>
  <h5>التطبيقات المضافة</h5>
  <div id="appList"></div>
</div>

<script>
let apps = [];
let clickCount = 0;

// فتح لوحة المطور بعد 5 ضغطات
document.getElementById("policyText").addEventListener("click", () => {
  clickCount++;
  if(clickCount >=5) {
    document.getElementById("adminPanel").style.display = "block";
    alert("تم فتح لوحة المطور!");
  }
});

// إضافة تطبيق
function addApp() {
  let name = document.getElementById("appName").value;
  let desc = document.getElementById("appDesc").value;
  let link = document.getElementById("appLink").value;
  let platform = document.getElementById("appPlatform").value;
  let category = document.getElementById("appCategory").value;
  let version = document.getElementById("appVersion").value;
  let fileInput = document.getElementById("appFile");
  let imageInput = document.getElementById("appImageFile");

  if(!name || !desc || (!link && !fileInput.files[0])) { alert("الرجاء تعبئة الحقول الأساسية أو رفع ملف"); return; }

  // قراءة الصورة محليًا باستخدام FileReader
  let imageURL = "";
  if(imageInput.files[0]){
    let reader = new FileReader();
    reader.onload = function(e){
      imageURL = e.target.result;
      saveApp(name, desc, link, fileInput, imageURL, platform, category, version);
    }
    reader.readAsDataURL(imageInput.files[0]);
  } else {
    saveApp(name, desc, link, fileInput, "", platform, category, version);
  }
}

function saveApp(name, desc, link, fileInput, imageURL, platform, category, version){
  let fileURL = link;
  if(fileInput.files[0] && !link){
    fileURL = "#NOT_FOUND"; // المحاكاة
  }

  let app = {
    name, desc, link: fileURL, image: imageURL, platform, category, version,
    comments: [], rating:0,
    id: "cdg1::" + Math.random().toString(36).substring(2,10) + "-" + Date.now()
  };
  apps.push(app);
  renderApps();
  renderAdminList();
}

// عرض التطبيقات
function renderApps(filter=null) {
  let container = document.getElementById("appsContainer");
  container.innerHTML = "";
  let displayApps = filter ? apps.filter(a => a.category===filter || a.platform===filter) : apps;
  
  displayApps.forEach((app,index)=>{
    let stars = "";
    for(let i=1;i<=5;i++){
      stars += `<span class="star" onclick="rateApp(${index},${i})">&#9733;</span>`;
    }
    let commentsHTML = app.comments.map(c=>`<div>${c}</div>`).join("");
    container.innerHTML += `
    <div class="col-md-3 mb-3">
      <div class="card">
        ${app.image?`<img src="${app.image}" class="app-image">`:""}
        <div class="card-body">
          <h5>${app.name}</h5>
          <p>${app.desc}</p>
          <p><strong>${app.platform}</strong> | ${app.category} | ${app.version}</p>
          <p>بطاقة تعريف: ${app.id}</p>
          <div>${stars}</div>
          <a href="${app.link}" class="btn download-btn mt-2" target="_blank" onclick="checkLink('${app.link}')">تنزيل</a>
          <div class="comment-box mt-2">
            <input type="text" id="comment${index}" placeholder="تعليق..." class="form-control mb-1">
            <button class="btn btn-sm btn-primary" onclick="addComment(${index})">أضف تعليق</button>
          </div>
          <div id="commentsList${index}">${commentsHTML}</div>
          <button class="btn btn-sm btn-warning mt-1" onclick="reportApp(${index})">الإبلاغ عن التطبيق</button>
        </div>
      </div>
    </div>
    `;
  });
}

function checkLink(link){ if(link === "#NOT_FOUND"){ alert("غير موجود\nشفرة: NOT_FOUND"); } }
function addComment(index){ let commentInput = document.getElementById(`comment${index}`); let text = commentInput.value.trim(); if(text){ apps[index].comments.push(text); renderApps(); } }
function rateApp(index, stars){ apps[index].rating = stars; renderApps(); }
function reportApp(index){ alert("تم إرسال البلاغ!"); }

function renderAdminList(){
  let container = document.getElementById("appList");
  container.innerHTML = "";
  apps.forEach((app,index)=>{
    container.innerHTML += `
      <div class="border p-2 mb-2">
        <b>${app.name}</b> (${app.platform} | ${app.category} | ${app.version})
        <button class="btn btn-sm btn-danger float-end" onclick="deleteApp(${index})">حذف</button>
      </div>
    `;
  });
}

function deleteApp(index){ apps.splice(index,1); renderApps(); renderAdminList(); }
function filterCategory(category){ renderApps(category); }
function searchApp(){ let query = document.getElementById("searchInput").value.trim().toLowerCase(); if(query==="hex app store"){ window.location.href = window.location.origin; } else{ alert("لم يتم العثور على التطبيق"); } }

renderApps();
</script>

</body>
</html>
